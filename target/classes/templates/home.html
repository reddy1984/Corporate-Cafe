<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>Corporate Café</title>
	<link rel="stylesheet" th:href="@{/css/styles.css}" />
</head>
<body>
<div class="container">
	<h1>Corporate Café</h1>

	<div class="user-select">
		<form method="get" th:action="@{/}">
			<label>Employee:</label>
			<select name="user">
				<option th:each="u : ${users}" th:value="${u.id}" th:text="${u.name}" th:selected="${selectedUser != null and u.id == selectedUser.id}"></option>
			</select>
			<button type="submit">Select</button>
		</form>
		<div th:if="${selectedUser}">
			Wallet: $<span th:text="${#numbers.formatDecimal(selectedUser.walletBalance, 1, 'COMMA', 2, 'POINT')}"></span>
			&bullet; Credits: $<span th:text="${#numbers.formatDecimal(selectedUser.monthlyCredits, 1, 'COMMA', 2, 'POINT')}"></span>
		</div>
	</div>

	<div th:if="${error}" class="error" th:text="${error}"></div>

	<h2>Menu</h2>
	<form method="post" th:action="@{/checkout}">
		<input type="hidden" name="userId" th:value="${selectedUser != null ? selectedUser.id : ''}" />
		<table class="menu">
			<thead>
			<tr><th>Item</th><th>Price</th><th>Calories</th><th>Tags</th><th>In Stock</th><th>Qty</th></tr>
			</thead>
			<tbody>
			<tr th:each="item : ${menu}">
				<td th:text="${item.name}"></td>
				<td>$<span th:text="${#numbers.formatDecimal(item.price,1,'COMMA',2,'POINT')}"></span></td>
				<td th:text="${item.calories}"></td>
				<td>
					<span th:if="${item.vegan}" class="tag">vegan</span>
					<span th:if="${item.glutenFree}" class="tag">gluten-free</span>
				</td>
				<td th:text="${inventory.get(item.id) != null ? inventory.get(item.id).quantity : 0}"></td>
				<td>
					<input type="hidden" name="itemId" th:value="${item.id}" />
					<input type="number" min="0" value="0" name="qty" />
				</td>
			</tr>
			</tbody>
		</table>

		<div class="payment">
			<label>Payment:</label>
			<select name="method">
				<option value="WALLET">Wallet</option>
				<option value="CREDITS">Credits</option>
				<option value="CARD">Card</option>
			</select>
			<button type="submit" th:disabled="${selectedUser == null}">Checkout</button>
			<a th:href="@{/analytics}">View Analytics</a>
		</div>
	</form>

	<h2>Feedback</h2>
	<form method="post" th:action="@{/feedback}">
		<label>Order ID:</label>
		<input name="orderId" placeholder="Paste order ID" />
		<label>Rating:</label>
		<select name="rating"><option>1</option><option>2</option><option>3</option><option>4</option><option selected>5</option></select>
		<label>Comment:</label>
		<input name="comment" placeholder="Your feedback" />
		<button type="submit">Submit</button>
	</form>
</div>
</body>
</html> 